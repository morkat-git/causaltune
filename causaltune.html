<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Public Module Reference &mdash; CausalTune 2022 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Standard errors" href="notebooks/Standard%20errors.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            CausalTune
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="whatcanthisdo.html">What can this do for you?</a></li>
<li class="toctree-l1"><a class="reference internal" href="howitworks.html">Model selection</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebook_examples.html">Examples</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Public Module Reference</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#causaltune-optimiser-module">causaltune.optimiser module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-causaltune.scoring">causaltune.scoring module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#causaltune-data-utils-module">causaltune.data_utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-causaltune.datasets">causaltune.datasets module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-causaltune.visualizer">causaltune.visualizer module</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">CausalTune</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Public Module Reference</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/causaltune.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="public-module-reference">
<h1>Public Module Reference<a class="headerlink" href="#public-module-reference" title="Permalink to this headline"></a></h1>
<section id="causaltune-optimiser-module">
<h2>causaltune.optimiser module<a class="headerlink" href="#causaltune-optimiser-module" title="Permalink to this headline"></a></h2>
<p>The main class of the package is CausalTune within the optimiser module.</p>
<span class="target" id="module-causaltune.optimiser"></span><dl class="py class">
<dt class="sig sig-object py" id="causaltune.optimiser.CausalTune">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">causaltune.optimiser.</span></span><span class="sig-name descname"><span class="pre">CausalTune</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'energy_distance'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics_to_report</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_budget</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">use_ray</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimator_list</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'auto'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.8</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">test_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">propensity_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'dummy'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outcome_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components_task</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'regression'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components_verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components_pred_time_limit</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components_njobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">components_time_budget</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">try_init_configs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resources_per_trial</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_experimental_estimators</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">store_all_estimators</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/optimiser.html#CausalTune"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.optimiser.CausalTune" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Performs AutoML to find best EconML estimator.
Optimises hyperparams of component models of each estimator
and hyperparams of the estimators themselves. Uses the ERUPT
metric for estimator selection.</p>
<p>Example:</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>CausalityDataset<span class="o">(</span><span class="nv">data</span><span class="o">=</span>df,<span class="w"> </span><span class="nv">treatment</span><span class="o">=</span><span class="s1">&#39;T&#39;</span>,<span class="w"> </span><span class="nv">outcomes</span><span class="o">=[</span><span class="s1">&#39;Y&#39;</span><span class="o">])</span>
cd.preprocess_dataset<span class="o">()</span>

<span class="nv">estimator_list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span><span class="s2">&quot;.LinearDML&quot;</span>,<span class="s2">&quot;LinearDRLearner&quot;</span>,<span class="s2">&quot;metalearners&quot;</span><span class="o">]</span>
<span class="nv">ct</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>CausalTune<span class="o">(</span><span class="nv">time_budget</span><span class="o">=</span><span class="m">10</span>,<span class="w"> </span><span class="nv">estimator_list</span><span class="o">=</span>estimator_list<span class="o">)</span>

ct.fit<span class="o">(</span><span class="nb">cd</span><span class="o">)</span>

print<span class="o">(</span>f<span class="s2">&quot;Best estimator: {ct.best_estimator}&quot;</span><span class="o">)</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="causaltune.optimiser.CausalTune.best_config">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">best_config</span></span><a class="headerlink" href="#causaltune.optimiser.CausalTune.best_config" title="Permalink to this definition"></a></dt>
<dd><p>Returns:
(dict): the best configuration</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="causaltune.optimiser.CausalTune.best_config_per_estimator">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">best_config_per_estimator</span></span><a class="headerlink" href="#causaltune.optimiser.CausalTune.best_config_per_estimator" title="Permalink to this definition"></a></dt>
<dd><p>Returns:
(dict): all estimators’ best configuration.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="causaltune.optimiser.CausalTune.best_estimator">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">best_estimator</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#causaltune.optimiser.CausalTune.best_estimator" title="Permalink to this definition"></a></dt>
<dd><p>A string indicating the best estimator found</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.optimiser.CausalTune.best_model_for_estimator">
<span class="sig-name descname"><span class="pre">best_model_for_estimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">estimator_name</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/optimiser.html#CausalTune.best_model_for_estimator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.optimiser.CausalTune.best_model_for_estimator" title="Permalink to this definition"></a></dt>
<dd><p>Return the best model found for a particular estimator.
estimator: self.tune_results[estimator].best_config</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>estimator_name</strong> (<em>str</em>) – the estimator’s name.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the best model for estimator_name.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(dowhy.causal_estimator.CausalEstimate)</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="causaltune.optimiser.CausalTune.best_score">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">best_score</span></span><a class="headerlink" href="#causaltune.optimiser.CausalTune.best_score" title="Permalink to this definition"></a></dt>
<dd><p>Returns:
(float):  the best score found.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="causaltune.optimiser.CausalTune.best_score_per_estimator">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">best_score_per_estimator</span></span><a class="headerlink" href="#causaltune.optimiser.CausalTune.best_score_per_estimator" title="Permalink to this definition"></a></dt>
<dd><p>A dictionary of all estimators’ best score.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.optimiser.CausalTune.effect">
<span class="sig-name descname"><span class="pre">effect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/optimiser.html#CausalTune.effect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.optimiser.CausalTune.effect" title="Permalink to this definition"></a></dt>
<dd><p>Heterogeneous Treatment Effects for data df</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pd.DataFrame</em>) – data to predict treatment effect for</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>predicted treatment effect for each datapoint</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(np.ndarray)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.optimiser.CausalTune.effect_inference">
<span class="sig-name descname"><span class="pre">effect_inference</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/optimiser.html#CausalTune.effect_inference"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.optimiser.CausalTune.effect_inference" title="Permalink to this definition"></a></dt>
<dd><p>Inference (uncertainty) results produced by best estimator
Only implemented for EconML estimators so far</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – data to run inference on</p></li>
<li><p><strong>args</strong> – passed through to underlying estimator</p></li>
<li><p><strong>kwargs</strong> – passed through to underlying estimator</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>NormalInferenceResults):</dt><dd><p>EconML results object for inference assuming a normal distribution.
from EconML: NormalInferenceResults:</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(from EconML</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.optimiser.CausalTune.effect_stderr">
<span class="sig-name descname"><span class="pre">effect_stderr</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_bootstrap_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_jobs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/optimiser.html#CausalTune.effect_stderr"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.optimiser.CausalTune.effect_stderr" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Compute standard errors for best causal estimator</dt><dd><p>Currently implemented for EconML estimators.
Computes analytical standard errors if available and boostraps otherwise.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – data to run inference on</p></li>
<li><p><strong>n_bootstrap_samples</strong> (<em>int</em><em>, </em><em>optional</em>) – number of runs if standard errors are boostrapped. Defaults to 5.</p></li>
<li><p><strong>n_jobs</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of bootstrap estimates to run in parallel. Defaults to 1.</p></li>
<li><p><strong>df</strong> – data to run inference on</p></li>
<li><p><strong>n_bootstrap_samples</strong> – number of runs if standard errors are boostrapped. Defaults to 5.</p></li>
<li><p><strong>n_jobs</strong> – Number of bootstrap estimates to run in parallel. Defaults to 1.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>standard error for each data point from df</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>(np.ndarray)</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>standard error for each data point from df</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.optimiser.CausalTune.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">pandas.core.frame.DataFrame</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="#causaltune.data_utils.CausalityDataset" title="causaltune.data_utils.CausalityDataset"><span class="pre">causaltune.data_utils.CausalityDataset</span></a><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">treatment</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outcome</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">common_causes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">effect_modifiers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">instruments</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">propensity_modifiers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimator_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resume</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">time_budget</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/optimiser.html#CausalTune.fit"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.optimiser.CausalTune.fit" title="Permalink to this definition"></a></dt>
<dd><p>Performs AutoML on list of causal inference estimators
- If estimator has a search space specified in its parameters, HPO is performed on the whole model.
- Otherwise, only its component models are optimised</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data</strong> (<em>pandas.DataFrame</em>) – dataset for causal inference</p></li>
<li><p><strong>treatment</strong> (<em>str</em>) – name of treatment variable</p></li>
<li><p><strong>outcome</strong> (<em>str</em>) – name of outcome variable</p></li>
<li><p><strong>common_causes</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – list of names of common causes</p></li>
<li><p><strong>effect_modifiers</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – list of names of effect modifiers</p></li>
<li><p><strong>instruments</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – list of names of instrumental variables</p></li>
<li><p><strong>propensity_modifiers</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – list of names of propensity modifiers</p></li>
<li><p><strong>estimator_list</strong> (<em>Optional</em><em>[</em><em>Union</em><em>[</em><em>str</em><em>, </em><em>List</em><em>[</em><em>str</em><em>]</em><em>]</em><em>]</em>) – subset of estimators to consider</p></li>
<li><p><strong>resume</strong> (<em>Optional</em><em>[</em><em>bool</em><em>]</em>) – set to True to continue previous fit</p></li>
<li><p><strong>time_budget</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em>) – change new time budget allocated to fit, useful for warm starts.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.optimiser.CausalTune.get_estimators">
<span class="sig-name descname"><span class="pre">get_estimators</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/optimiser.html#CausalTune.get_estimators"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.optimiser.CausalTune.get_estimators" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.optimiser.CausalTune.get_params">
<span class="sig-name descname"><span class="pre">get_params</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">deep</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/optimiser.html#CausalTune.get_params"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.optimiser.CausalTune.get_params" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.optimiser.CausalTune.init_outcome_model">
<span class="sig-name descname"><span class="pre">init_outcome_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">outcome_model</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/optimiser.html#CausalTune.init_outcome_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.optimiser.CausalTune.init_outcome_model" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.optimiser.CausalTune.init_propensity_model">
<span class="sig-name descname"><span class="pre">init_propensity_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">propensity_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/optimiser.html#CausalTune.init_propensity_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.optimiser.CausalTune.init_propensity_model" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="causaltune.optimiser.CausalTune.model">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">model</span></span><a class="headerlink" href="#causaltune.optimiser.CausalTune.model" title="Permalink to this definition"></a></dt>
<dd><p>Return the <em>trained</em> best estimator</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>CausalEstimator</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.optimiser.CausalTune.score_dataset">
<span class="sig-name descname"><span class="pre">score_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataset_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/optimiser.html#CausalTune.score_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.optimiser.CausalTune.score_dataset" title="Permalink to this definition"></a></dt>
<dd><p>After fitting, generate scores for an additional dataset, add them to the scores dict.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – input dataframe</p></li>
<li><p><strong>dataset_name</strong> (<em>str</em>) – dictionary key</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.optimiser.CausalTune.update_summary_scores">
<span class="sig-name descname"><span class="pre">update_summary_scores</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/optimiser.html#CausalTune.update_summary_scores"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.optimiser.CausalTune.update_summary_scores" title="Permalink to this definition"></a></dt>
<dd><p>Stores scores for metric of interest for each estimator</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-causaltune.scoring">
<span id="causaltune-scoring-module"></span><h2>causaltune.scoring module<a class="headerlink" href="#module-causaltune.scoring" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="causaltune.scoring.DummyEstimator">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">causaltune.scoring.</span></span><span class="sig-name descname"><span class="pre">DummyEstimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cate_estimate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">effect_intervals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/scoring.html#DummyEstimator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.scoring.DummyEstimator" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="causaltune.scoring.DummyEstimator.const_marginal_effect">
<span class="sig-name descname"><span class="pre">const_marginal_effect</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/scoring.html#DummyEstimator.const_marginal_effect"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.scoring.DummyEstimator.const_marginal_effect" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="causaltune.scoring.Scorer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">causaltune.scoring.</span></span><span class="sig-name descname"><span class="pre">Scorer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">causal_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dowhy.causal_model.CausalModel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">propensity_model</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">problem</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multivalue</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/scoring.html#Scorer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.scoring.Scorer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="causaltune.scoring.Scorer.ate">
<span class="sig-name descname"><span class="pre">ate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span></span></span><a class="reference internal" href="_modules/causaltune/scoring.html#Scorer.ate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.scoring.Scorer.ate" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the Average Treatment Effect. Provide naive std estimates in single-treatment cases.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>df</strong> (<em>pandas.DataFrame</em>) – input dataframe</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>tuple containing the ATE, standard deviation of the estimate (or None if multi-treatment),</dt><dd><p>and sample size (or None if estimate has more than one dimension)</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.scoring.Scorer.auc_make_score">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">auc_make_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">estimate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dowhy.causal_estimator.CausalEstimate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cate_estimate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/causaltune/scoring.html#Scorer.auc_make_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.scoring.Scorer.auc_make_score" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the area under the uplift curve.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>estimate</strong> (<em>dowhy.causal_estimator.CausalEstimate</em>) – causal estimate to evaluate</p></li>
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – input dataframe</p></li>
<li><p><strong>cate_estimate</strong> (<em>np.ndarray</em>) – array with cate estimates</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>area under the uplift curve</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.scoring.Scorer.best_score_by_estimator">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">best_score_by_estimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scores</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/causaltune/scoring.html#Scorer.best_score_by_estimator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.scoring.Scorer.best_score_by_estimator" title="Permalink to this definition"></a></dt>
<dd><p>Obtain best score for each estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scores</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>dict</em><em>]</em>) – CausalTune.scores dictionary</p></li>
<li><p><strong>metric</strong> (<em>str</em>) – metric of interest</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dictionary containing best score by estimator</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Dict[str, dict]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.scoring.Scorer.energy_distance_score">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">energy_distance_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">estimate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dowhy.causal_estimator.CausalEstimate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/causaltune/scoring.html#Scorer.energy_distance_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.scoring.Scorer.energy_distance_score" title="Permalink to this definition"></a></dt>
<dd><p>Calculate energy distance score between treated and controls.
For theoretical details, see Ramos-Carreño and Torrecilla (2023).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>estimate</strong> (<em>dowhy.causal_estimator.CausalEstimate</em>) – causal estimate to evaluate</p></li>
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – input dataframe</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>energy distance score</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.scoring.Scorer.group_ate">
<span class="sig-name descname"><span class="pre">group_ate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">policy</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">pandas.core.frame.DataFrame</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pandas.core.frame.DataFrame</span></span></span><a class="reference internal" href="_modules/causaltune/scoring.html#Scorer.group_ate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.scoring.Scorer.group_ate" title="Permalink to this definition"></a></dt>
<dd><p>Compute the average treatment effect (ATE) for different groups specified by a policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – input dataframe, should contain columns for the treatment, outcome, and policy</p></li>
<li><p><strong>policy</strong> (<em>Union</em><em>[</em><em>pd.DataFrame</em><em>, </em><em>np.ndarray</em><em>]</em>) – policy column in df or an array of the policy values,
used to group the data</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>ATE, std, and size per policy</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.scoring.Scorer.make_scores">
<span class="sig-name descname"><span class="pre">make_scores</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">estimate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dowhy.causal_estimator.CausalEstimate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics_to_report</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_scorer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="_modules/causaltune/scoring.html#Scorer.make_scores"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.scoring.Scorer.make_scores" title="Permalink to this definition"></a></dt>
<dd><p>Calculate various performance metrics for a given causal estimate using a given DataFrame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>estimate</strong> (<em>dowhy.causal_estimator.CausalEstimate</em>) – causal estimate to evaluate</p></li>
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – input dataframe</p></li>
<li><p><strong>metrics_to_report</strong> (<em>List</em><em>[</em><em>str</em><em>]</em>) – list of strings specifying the evaluation metrics to compute.
Possible options include ‘ate’, ‘erupt’, ‘norm_erupt’, ‘qini’, ‘auc’, and ‘energy_distance’.</p></li>
<li><p><strong>r_scorer</strong> (<em>Optional</em>) – callable object used to compute the R-score, default is None</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>dictionary containing the evaluation metrics specified in metrics_to_report.</dt><dd><p>The values key in the dictionary contains the input DataFrame with additional columns for
the propensity scores, the policy, the normalized policy, and the weights, if applicable.</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.scoring.Scorer.naive_ate">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">naive_ate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">treatment</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pandas.core.series.Series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outcome</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pandas.core.series.Series</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/scoring.html#Scorer.naive_ate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.scoring.Scorer.naive_ate" title="Permalink to this definition"></a></dt>
<dd><p>Calculate simple ATE.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>treatment</strong> (<em>pandas.Series</em>) – series of treatments</p></li>
<li><p><strong>outcome</strong> (<em>pandas.Series</em>) – series of outcomes</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tuple of simple ATE, standard deviation, and sample size</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.scoring.Scorer.qini_make_score">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">qini_make_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">estimate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dowhy.causal_estimator.CausalEstimate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cate_estimate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/causaltune/scoring.html#Scorer.qini_make_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.scoring.Scorer.qini_make_score" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the Qini score, defined as the area between the Qini curves of a model and random.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>estimate</strong> (<em>dowhy.causal_estimator.CausalEstimate</em>) – causal estimate to evaluate</p></li>
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – input dataframe</p></li>
<li><p><strong>cate_estimate</strong> (<em>np.ndarray</em>) – array with cate estimates</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Qini score</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.scoring.Scorer.r_make_score">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">r_make_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">estimate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dowhy.causal_estimator.CausalEstimate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cate_estimate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">r_scorer</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/causaltune/scoring.html#Scorer.r_make_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.scoring.Scorer.r_make_score" title="Permalink to this definition"></a></dt>
<dd><p>Calculate r_score.
For details refer to Nie and Wager (2017) and Schuler et al. (2018). Adaption from EconML implementation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>estimate</strong> (<em>dowhy.causal_estimator.CausalEstimate</em>) – causal estimate to evaluate</p></li>
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – input dataframe</p></li>
<li><p><strong>cate_estimate</strong> (<em>np.ndarray</em>) – array with cate estimates</p></li>
<li><p><strong>r_scorer</strong> – callable object used to compute the R-score</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>r_score</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.scoring.Scorer.real_qini_make_score">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">real_qini_make_score</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">estimate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dowhy.causal_estimator.CausalEstimate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cate_estimate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.ndarray</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/causaltune/scoring.html#Scorer.real_qini_make_score"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.scoring.Scorer.real_qini_make_score" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.scoring.Scorer.resolve_metric">
<span class="sig-name descname"><span class="pre">resolve_metric</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metric</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">str</span></span></span><a class="reference internal" href="_modules/causaltune/scoring.html#Scorer.resolve_metric"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.scoring.Scorer.resolve_metric" title="Permalink to this definition"></a></dt>
<dd><p>Check if supplied metric is supported. If not, default to ‘energy_distance’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>metric</strong> (<em>str</em>) – evaluation metric</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>metric/’energy_distance’</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.scoring.Scorer.resolve_reported_metrics">
<span class="sig-name descname"><span class="pre">resolve_reported_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metrics_to_report</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scoring_metric</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/causaltune/scoring.html#Scorer.resolve_reported_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.scoring.Scorer.resolve_reported_metrics" title="Permalink to this definition"></a></dt>
<dd><p>Check if supplied reporting metrics are valid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>metrics_to_report</strong> (<em>Union</em><em>[</em><em>List</em><em>[</em><em>str</em><em>]</em><em>, </em><em>None</em><em>]</em>) – list of strings specifying the evaluation metrics to compute.
Possible options include ‘ate’, ‘erupt’, ‘norm_erupt’, ‘qini’, ‘auc’, and ‘energy_distance’.</p></li>
<li><p><strong>scoring_metric</strong> (<em>str</em>) – specified metric</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of valid metrics</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>List[str]</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="causaltune.scoring.supported_metrics">
<span class="sig-prename descclassname"><span class="pre">causaltune.scoring.</span></span><span class="sig-name descname"><span class="pre">supported_metrics</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">problem</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multivalue</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scores_only</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="_modules/causaltune/scoring.html#supported_metrics"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.scoring.supported_metrics" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="causaltune-data-utils-module">
<h2>causaltune.data_utils module<a class="headerlink" href="#causaltune-data-utils-module" title="Permalink to this headline"></a></h2>
<p>This module contains the CausalityDataset class which is used to define the data model.</p>
<span class="target" id="module-causaltune.data_utils"></span><dl class="py class">
<dt class="sig sig-object py" id="causaltune.data_utils.CausalityDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">causaltune.data_utils.</span></span><span class="sig-name descname"><span class="pre">CausalityDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">treatment</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outcomes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">common_causes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">NoneType</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">effect_modifiers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">NoneType</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">propensity_modifiers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">NoneType</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">instruments</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">NoneType</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/data_utils.html#CausalityDataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.data_utils.CausalityDataset" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py attribute">
<dt class="sig sig-object py" id="causaltune.data_utils.CausalityDataset.common_causes">
<span class="sig-name descname"><span class="pre">common_causes</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#causaltune.data_utils.CausalityDataset.common_causes" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="causaltune.data_utils.CausalityDataset.data">
<span class="sig-name descname"><span class="pre">data</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">pandas.core.frame.DataFrame</span></em><a class="headerlink" href="#causaltune.data_utils.CausalityDataset.data" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="causaltune.data_utils.CausalityDataset.effect_modifiers">
<span class="sig-name descname"><span class="pre">effect_modifiers</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#causaltune.data_utils.CausalityDataset.effect_modifiers" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="causaltune.data_utils.CausalityDataset.instruments">
<span class="sig-name descname"><span class="pre">instruments</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#causaltune.data_utils.CausalityDataset.instruments" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="causaltune.data_utils.CausalityDataset.outcomes">
<span class="sig-name descname"><span class="pre">outcomes</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#causaltune.data_utils.CausalityDataset.outcomes" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.data_utils.CausalityDataset.preprocess_dataset">
<span class="sig-name descname"><span class="pre">preprocess_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">drop_first</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_floats</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_min_categories</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_thresh</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.99</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/data_utils.html#CausalityDataset.preprocess_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.data_utils.CausalityDataset.preprocess_dataset" title="Permalink to this definition"></a></dt>
<dd><p>Preprocesses input dataset for CausalTune by
converting treatment and instrument columns to integer, normalizing, filling nans, and one-hot encoding.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>drop_first</strong> (<em>bool</em>) – whether to drop the first dummy variable for each categorical feature (default False)</p></li>
<li><p><strong>scale_floats</strong> (<em>bool</em>) – whether to scale float features to have zero mean and unit variance (default False)</p></li>
<li><p><strong>prune_min_categories</strong> (<em>int</em>) – min number of categories to keep for each categorical feature (default 50)</p></li>
<li><p><strong>prune_thresh</strong> (<em>float</em>) – threshold for category frequency when pruning categories (default 0.99)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None. Modifies self.data in-place by replacing it with the preprocessed dataframe.</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="causaltune.data_utils.CausalityDataset.propensity_modifiers">
<span class="sig-name descname"><span class="pre">propensity_modifiers</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#causaltune.data_utils.CausalityDataset.propensity_modifiers" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="causaltune.data_utils.CausalityDataset.treatment">
<span class="sig-name descname"><span class="pre">treatment</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="pre">str</span></em><a class="headerlink" href="#causaltune.data_utils.CausalityDataset.treatment" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="causaltune.data_utils.CausalityDataset.treatment_values">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">treatment_values</span></span><a class="headerlink" href="#causaltune.data_utils.CausalityDataset.treatment_values" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="causaltune.data_utils.featurize">
<span class="sig-prename descclassname"><span class="pre">causaltune.data_utils.</span></span><span class="sig-name descname"><span class="pre">featurize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">features</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exclude_cols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">drop_first</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scale_floats</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_min_categories</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">50</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prune_thresh</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.99</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pandas.core.frame.DataFrame</span></span></span><a class="reference internal" href="_modules/causaltune/data_utils.html#featurize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.data_utils.featurize" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="causaltune.data_utils.frequent_values">
<span class="sig-prename descclassname"><span class="pre">causaltune.data_utils.</span></span><span class="sig-name descname"><span class="pre">frequent_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pandas.core.series.Series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.99</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">set</span></span></span><a class="reference internal" href="_modules/causaltune/data_utils.html#frequent_values"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.data_utils.frequent_values" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="causaltune.data_utils.otherize_tail">
<span class="sig-prename descclassname"><span class="pre">causaltune.data_utils.</span></span><span class="sig-name descname"><span class="pre">otherize_tail</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pandas.core.series.Series</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">new_val</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresh</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.99</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_categories</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">20</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pandas.core.series.Series</span></span></span><a class="reference internal" href="_modules/causaltune/data_utils.html#otherize_tail"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.data_utils.otherize_tail" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

</section>
<section id="module-causaltune.datasets">
<span id="causaltune-datasets-module"></span><h2>causaltune.datasets module<a class="headerlink" href="#module-causaltune.datasets" title="Permalink to this headline"></a></h2>
<dl class="py function">
<dt class="sig sig-object py" id="causaltune.datasets.amazon_reviews">
<span class="sig-prename descclassname"><span class="pre">causaltune.datasets.</span></span><span class="sig-name descname"><span class="pre">amazon_reviews</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rating</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'pos'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#causaltune.data_utils.CausalityDataset" title="causaltune.data_utils.CausalityDataset"><span class="pre">causaltune.data_utils.CausalityDataset</span></a></span></span><a class="reference internal" href="_modules/causaltune/datasets.html#amazon_reviews"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.datasets.amazon_reviews" title="Permalink to this definition"></a></dt>
<dd><p>Loads amazon reviews dataset
The dataset describes the impact of positive (or negative) reviews for products on Amazon on sales.
The authors distinguish between items with more than three reviews (treated) and less than three
reviews (untreated). As the rating given by reviews might impact sales, they divide the dataset
into products with on average positive (more than 3 starts) or negative (less than three stars)
reviews.
The dataset consists of 305 covariates (doc2vec features of the review text), a binary treatment
variable (more than 3 reviews vs less than three reviews) and a continuous outcome (sales).</p>
<p>If used for academic purposes, please consider citing the authors:
&#64;inproceedings{rakesh2018linked,</p>
<blockquote>
<div><p>title={Linked Causal Variational Autoencoder for Inferring Paired Spillover Effects},
author={Rakesh, Vineeth and Guo, Ruocheng and Moraffah, Raha and Agarwal, Nitin and Liu, Huan},
booktitle={Proceedings of the 27th ACM International Conference on Information and Knowledge Management},
pages={1679–1682},
year={2018},
organization={ACM}</p>
</div></blockquote>
<p>}
:param rating: choose between positive (‘pos’) and negative (‘neg’) reviews. Defaults to ‘pos’.
:type rating: str, optional</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>dataset with cols “treatment”, “y_factual” and covariates “x1” to “x300”</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="causaltune.datasets.generate_non_random_dataset">
<span class="sig-prename descclassname"><span class="pre">causaltune.datasets.</span></span><span class="sig-name descname"><span class="pre">generate_non_random_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">num_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/datasets.html#generate_non_random_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.datasets.generate_non_random_dataset" title="Permalink to this definition"></a></dt>
<dd><p>Generates synthetic dataset with non-uniform propensities to treat.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>num_samples</strong> (<em>int</em><em>, </em><em>optional</em>) – number of independent samples. Defaults to 1000.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>data object</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#causaltune.data_utils.CausalityDataset" title="causaltune.data_utils.CausalityDataset">CausalityDataset</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="causaltune.datasets.generate_synth_data_with_categories">
<span class="sig-prename descclassname"><span class="pre">causaltune.datasets.</span></span><span class="sig-name descname"><span class="pre">generate_synth_data_with_categories</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">true_effect</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#causaltune.data_utils.CausalityDataset" title="causaltune.data_utils.CausalityDataset"><span class="pre">causaltune.data_utils.CausalityDataset</span></a></span></span><a class="reference internal" href="_modules/causaltune/datasets.html#generate_synth_data_with_categories"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.datasets.generate_synth_data_with_categories" title="Permalink to this definition"></a></dt>
<dd><dl class="simple">
<dt>Generates synthetic dataset just with categorical features</dt><dd><p>Can be used, e.g. in connection with Wise pizza segmentation analysis</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_samples</strong> (<em>int</em><em>, </em><em>optional</em>) – number of independent samples. Defaults to 10000.</p></li>
<li><p><strong>n_x</strong> (<em>int</em><em>, </em><em>optional</em>) – number of features. Must be at least 3. Defaults to 10.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>data object</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#causaltune.data_utils.CausalityDataset" title="causaltune.data_utils.CausalityDataset">CausalityDataset</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="causaltune.datasets.generate_synthetic_data">
<span class="sig-prename descclassname"><span class="pre">causaltune.datasets.</span></span><span class="sig-name descname"><span class="pre">generate_synthetic_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_samples</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_covariates</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covariance</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'isotropic'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confounding</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">linear_confounder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noisy_outcomes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">effect_size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_instrument</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#causaltune.data_utils.CausalityDataset" title="causaltune.data_utils.CausalityDataset"><span class="pre">causaltune.data_utils.CausalityDataset</span></a></span></span><a class="reference internal" href="_modules/causaltune/datasets.html#generate_synthetic_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.datasets.generate_synthetic_data" title="Permalink to this definition"></a></dt>
<dd><p>Generates synthetic dataset with conditional treatment effect (CATE) and optional instrumental variable.
Supports RCT (unconfounded) and observational (confounded) data.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_samples</strong> (<em>int</em><em>, </em><em>optional</em>) – number of independent samples. Defaults to 100.</p></li>
<li><p><strong>n_covariates</strong> (<em>int</em><em>, </em><em>optional</em>) – number of covariates. Defaults to 5.</p></li>
<li><p><strong>covariance</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>np.ndarray</em><em>]</em><em>, </em><em>optional</em>) – covariance matrix of covariates. can be “isotropic”,
“anisotropic” or user-supplied. Defaults to “isotropic”.</p></li>
<li><p><strong>confounding</strong> (<em>bool</em><em>, </em><em>optional</em>) – whether or not values of covariates affect treatment effect. Defaults to True.</p></li>
<li><p><strong>noisy_outcomes</strong> (<em>bool</em><em>, </em><em>optional</em>) – additive noise in the outcomes. Defaults to False.</p></li>
<li><p><strong>add_instrument</strong> (<em>bool</em><em>, </em><em>optional</em>) – include instrumental variable (yes/no). Defaults to False</p></li>
<li><p><strong>effect_size</strong> (<em>Union</em><em>[</em><em>int</em><em>, </em><em>None</em><em>]</em>) – if provided, constant effect size (ATE). if None, generate CATE.
Defaults to None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>columns for covariates, treatment assignment, outcome and true treatment effect</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#causaltune.data_utils.CausalityDataset" title="causaltune.data_utils.CausalityDataset">CausalityDataset</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="causaltune.datasets.iv_dgp_econml">
<span class="sig-prename descclassname"><span class="pre">causaltune.datasets.</span></span><span class="sig-name descname"><span class="pre">iv_dgp_econml</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">5000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">p</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">true_effect</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/datasets.html#iv_dgp_econml"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.datasets.iv_dgp_econml" title="Permalink to this definition"></a></dt>
<dd><p>Generates synthetic IV data for binary treatment and instruments.
Source: <a class="reference external" href="https://github.com/microsoft/EconML/tree/main/notebooks/">https://github.com/microsoft/EconML/tree/main/notebooks/</a>
Eg: OrthoIV and DRIV Examples.ipynb</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n</strong> (<em>int</em>) – number of data instances</p></li>
<li><p><strong>p</strong> (<em>int</em>) – number of observed features</p></li>
<li><p><strong>true_effect</strong> (<em>Union</em><em>[</em><em>float</em><em>, </em><em>int</em><em>, </em><em>Callable</em><em>]</em>) – known effect (function or value) to observe.
Can be a function of covariates or a constant</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>Data class containing (1) pd.DataFrame with columns “treatment”, “y”</dt><dd><p>and covariates from “x_0” to “x_{p}”, and labels for treatment,
outcome and instrument variables and</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference internal" href="#causaltune.data_utils.CausalityDataset" title="causaltune.data_utils.CausalityDataset">CausalityDataset</a></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="causaltune.datasets.lalonde_nsw">
<span class="sig-prename descclassname"><span class="pre">causaltune.datasets.</span></span><span class="sig-name descname"><span class="pre">lalonde_nsw</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#causaltune.data_utils.CausalityDataset" title="causaltune.data_utils.CausalityDataset"><span class="pre">causaltune.data_utils.CausalityDataset</span></a></span></span><a class="reference internal" href="_modules/causaltune/datasets.html#lalonde_nsw"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.datasets.lalonde_nsw" title="Permalink to this definition"></a></dt>
<dd><p>Loads the Lalonde NSW dataset
The dataset described the impact of a job training programme on the real earnings
of individuals several years later.
The data consists of the treatment indicator (training yes no), covariates (age, race,
academic background, real earnings 1976, real earnings 1977) and the outcome (real earnings in 1978)
See also <a class="reference external" href="https://rdrr.io/cran/qte/man/lalonde.html#heading-0">https://rdrr.io/cran/qte/man/lalonde.html#heading-0</a></p>
<p>If used for academic purposes, please consider citing the authors:
Lalonde, Robert: “Evaluating the Econometric Evaluations of Training Programs,” American Economic Review,
Vol. 76, pp. 604-620</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>dataset with cols “treatment”, “y_factual” and covariates “x1” to “x8”</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="causaltune.datasets.linear_multi_dataset">
<span class="sig-prename descclassname"><span class="pre">causaltune.datasets.</span></span><span class="sig-name descname"><span class="pre">linear_multi_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">impact</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_propensity</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">include_control</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#causaltune.data_utils.CausalityDataset" title="causaltune.data_utils.CausalityDataset"><span class="pre">causaltune.data_utils.CausalityDataset</span></a></span></span><a class="reference internal" href="_modules/causaltune/datasets.html#linear_multi_dataset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.datasets.linear_multi_dataset" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="causaltune.datasets.mlrate_experiment_synth_dgp">
<span class="sig-prename descclassname"><span class="pre">causaltune.datasets.</span></span><span class="sig-name descname"><span class="pre">mlrate_experiment_synth_dgp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_x</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">const_te</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">noise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cate_scaler</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/datasets.html#mlrate_experiment_synth_dgp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.datasets.mlrate_experiment_synth_dgp" title="Permalink to this definition"></a></dt>
<dd><p>Synthetic DGP taken from
Guo, Yongyi, et al. “Machine learning for variance reduction in online experiments.”
Advances in Neural Information Processing Systems 34 (2021): 8637-8648.
<a class="reference external" href="https://proceedings.neurips.cc/paper/2021/file/488b084119a1c7a4950f00706ec7ea16-Paper.pdf">https://proceedings.neurips.cc/paper/2021/file/488b084119a1c7a4950f00706ec7ea16-Paper.pdf</a></p>
<p>DGP:</p>
<p>Y_i = b(X_i) + T_i*(const_te+tau(X_i)) + noise*u_i
with
b(X_i) = 10*sin(pi*X_{i0}X_{i1}) + 20*(X_{i2}-.5)^2 + 10*X_{i3} + 5*X_{i4}</p>
<p>and</p>
<p>tau(X_i) = cate_scaler*(X_{i1} + log(1+exp(X_{i2})) - 0.805850803366056),
T_i ~ Bernoulli(.5), u_i ~ Normal(0,25^2)</p>
<p>The DGP is set up in a way that there ATE = const_te.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_samples</strong> (<em>int</em><em>, </em><em>optional</em>) – sample size. Defaults to 10000.</p></li>
<li><p><strong>n_x</strong> (<em>int</em><em>, </em><em>optional</em>) – number of covariates. At least 4. Defaults to 100.</p></li>
<li><p><strong>const_te</strong> (<em>float</em><em>, </em><em>optional</em>) – constant average treatment effect</p></li>
<li><p><strong>noise</strong> (<em>float</em><em>, </em><em>optional</em>) – exogeneous variance scaler</p></li>
<li><p><strong>cate_scaler</strong> (<em>float</em><em>, </em><em>optional</em>) – heterogeneous treatment effect scaler</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>data object for causal inference</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>cd (<a class="reference internal" href="#causaltune.data_utils.CausalityDataset" title="causaltune.data_utils.CausalityDataset">CausalityDataset</a>)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="causaltune.datasets.nhefs">
<span class="sig-prename descclassname"><span class="pre">causaltune.datasets.</span></span><span class="sig-name descname"><span class="pre">nhefs</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#causaltune.data_utils.CausalityDataset" title="causaltune.data_utils.CausalityDataset"><span class="pre">causaltune.data_utils.CausalityDataset</span></a></span></span><a class="reference internal" href="_modules/causaltune/datasets.html#nhefs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.datasets.nhefs" title="Permalink to this definition"></a></dt>
<dd><p>Loads the NHEFS dataset
The dataset describes the impact of quitting smoke on weight gain over a period of 11 years
The data consists of the treatment (quit smoking yes no), the outcome (change in weight) and
a series of covariates of which we include a subset of 9 (see below).</p>
<p>If used for academic purposes, pelase consider citing the authors:
Hernán MA, Robins JM (2020). Causal Inference: What If. Boca Raton: Chapman &amp; Hall/CRC.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>dataset with cols “treatment”, “y_factual” and covariates “x1” to “x9”</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="causaltune.datasets.synth_acic">
<span class="sig-prename descclassname"><span class="pre">causaltune.datasets.</span></span><span class="sig-name descname"><span class="pre">synth_acic</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">condition</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#causaltune.data_utils.CausalityDataset" title="causaltune.data_utils.CausalityDataset"><span class="pre">causaltune.data_utils.CausalityDataset</span></a></span></span><a class="reference internal" href="_modules/causaltune/datasets.html#synth_acic"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.datasets.synth_acic" title="Permalink to this definition"></a></dt>
<dd><p>Loads data from ACIC Causal Inference Challenge 2016
The dataset consists of 58 covariates, a binary treatment and a continuous response.
There are 10 simulated pairs of treatment and response, which can be selected
with the condition argument supplied to this function.</p>
<p>If used for academic purposes, consider citing the authors:
&#64;article{dorie2019automated,</p>
<blockquote>
<div><dl class="simple">
<dt>title={Automated versus do-it-yourself methods for causal inference: Lessons learned from a</dt><dd><p>data analysis competition},</p>
</dd>
</dl>
<p>author={Dorie, Vincent and Hill, Jennifer and Shalit, Uri and Scott, Marc and Cervone, Dan},
journal={Statistical Science},
volume={34},
number={1},
pages={43–68},
year={2019},
publisher={Institute of Mathematical Statistics}</p>
</div></blockquote>
<p>}</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>condition</strong> (<em>int</em>) – in [1,10], corresponds to 10 simulated treatment/response pairs. Defaults to 1.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dataset for causal inference with columns “treatment”, “y_factual” and covariates “x_1” to “x_58”</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="causaltune.datasets.synth_ihdp">
<span class="sig-prename descclassname"><span class="pre">causaltune.datasets.</span></span><span class="sig-name descname"><span class="pre">synth_ihdp</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">return_df</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><a class="reference internal" href="#causaltune.data_utils.CausalityDataset" title="causaltune.data_utils.CausalityDataset"><span class="pre">causaltune.data_utils.CausalityDataset</span></a></span></span><a class="reference internal" href="_modules/causaltune/datasets.html#synth_ihdp"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.datasets.synth_ihdp" title="Permalink to this definition"></a></dt>
<dd><p>Loads IHDP dataset
The Infant Health and Development Program (IHDP) dataset contains data on the impact of visits by specialists
on the cognitive development of children. The dataset consists of 25 covariates describing various features
of these children and their mothers, a binary treatment variable (visit/no visit) and a continuous outcome.</p>
<p>If used for academic purposes, consider citing the authors:
&#64;article{hill2011,</p>
<blockquote>
<div><p>title={Bayesian nonparametric modeling for causal inference.},
author={Hill, Jennifer},
journal={Journal of Computational and Graphical Statistics},
volume={20},
number={1},
pages={217–240},
year={2011}</p>
</div></blockquote>
<p>}</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>return_df</strong> (<em>bool</em>) – whether or not to return dataset as pd.DataFrame</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dataset for causal inference with cols “treatment”, “y_factual” and covariates “x1” to “x25”</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-causaltune.visualizer">
<span id="causaltune-visualizer-module"></span><h2>causaltune.visualizer module<a class="headerlink" href="#module-causaltune.visualizer" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="causaltune.visualizer.Visualizer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">causaltune.visualizer.</span></span><span class="sig-name descname"><span class="pre">Visualizer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">test_df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">treatment_col_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outcome_col_name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/causaltune/visualizer.html#Visualizer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.visualizer.Visualizer" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="causaltune.visualizer.Visualizer.plot_group_ate">
<span class="sig-name descname"><span class="pre">plot_group_ate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scorer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><a class="reference internal" href="#causaltune.scoring.Scorer" title="causaltune.scoring.Scorer"><span class="pre">causaltune.scoring.Scorer</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">scores_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">estimator</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">pandas.core.frame.DataFrame</span></span></span><a class="reference internal" href="_modules/causaltune/visualizer.html#Visualizer.plot_group_ate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.visualizer.Visualizer.plot_group_ate" title="Permalink to this definition"></a></dt>
<dd><p>Plot out-of sample difference of outcomes between treated and untreated
for the points where model predicts positive vs negative impact.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scorer</strong> (<em>CausalTune.scorer</em>) – scorer from CausalTune</p></li>
<li><p><strong>scores_dict</strong> (<em>Dict</em>) – scores dict from fitted CausalTune object</p></li>
<li><p><strong>estimator</strong> (<em>str</em>) – name of estimator to use</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dataframe of policy groups and average effect</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.visualizer.Visualizer.plot_metrics_by_estimator">
<span class="sig-name descname"><span class="pre">plot_metrics_by_estimator</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">scores_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figtitle</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">metrics</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">('norm_erupt',</span> <span class="pre">'ate')</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(7,</span> <span class="pre">5)</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/causaltune/visualizer.html#Visualizer.plot_metrics_by_estimator"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.visualizer.Visualizer.plot_metrics_by_estimator" title="Permalink to this definition"></a></dt>
<dd><p>Plot metrics by estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>scores_dict</strong> (<em>Dict</em>) – scores dict from fitted CausalTune object</p></li>
<li><p><strong>figtitle</strong> (<em>str</em>) – specifying plot title, defaults to “”</p></li>
<li><p><strong>metrics</strong> (<em>Tuple</em><em>[</em><em>str</em><em>, </em><em>str</em><em>]</em>) – specifying metrics, defaults to (‘norm_erupt’, ‘ate’)</p></li>
<li><p><strong>figsize</strong> (<em>Tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em>) – specifying plot size, defaults to (7,5)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="causaltune.visualizer.Visualizer.plot_shap">
<span class="sig-name descname"><span class="pre">plot_shap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">estimate</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dowhy.causal_estimator.CausalEstimate</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shaps</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figtitle</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="_modules/causaltune/visualizer.html#Visualizer.plot_shap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#causaltune.visualizer.Visualizer.plot_shap" title="Permalink to this definition"></a></dt>
<dd><p>Plot Shapley values for given estimator.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>estimate</strong> (<em>CausalEstimate</em>) – dowhy causal estimate</p></li>
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – dataframe for shapley calculation</p></li>
<li><p><strong>shaps</strong> (<em>np.ndarray</em>) – pre-computed shapley values, if None, compute shapley values. Defaults to None.</p></li>
<li><p><strong>figtitle</strong> (<em>str</em>) – plot title</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="notebooks/Standard%20errors.html" class="btn btn-neutral float-left" title="Standard errors" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Wise Payments Limited, PyWhy Contributors.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>